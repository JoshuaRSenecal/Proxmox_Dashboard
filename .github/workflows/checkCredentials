#!/usr/bin/env python3
"""
Verify credentials file changes
This script shows file details without decrypting
"""
import os
import hashlib
from datetime import datetime

CREDENTIALS_FILE = os.path.expanduser('~/.proxmox_credentials.enc')

print("=" * 60)
print("Proxmox Credentials File Checker")
print("=" * 60)
print()

if not os.path.exists(CREDENTIALS_FILE):
    print(f"❌ Credentials file does NOT exist")
    print(f"   Expected location: {CREDENTIALS_FILE}")
    exit(1)

print(f"✓ File exists: {CREDENTIALS_FILE}")
print()

# File stats
stat = os.stat(CREDENTIALS_FILE)
print(f"File size:        {stat.st_size} bytes")
print(f"Last modified:    {datetime.fromtimestamp(stat.st_mtime).strftime('%Y-%m-%d %H:%M:%S')}")
print(f"Permissions:      {oct(stat.st_mode)[-3:]}")
print()

# Read file content
with open(CREDENTIALS_FILE, 'rb') as f:
    content = f.read()

# Calculate hash
file_hash = hashlib.sha256(content).hexdigest()

print(f"SHA256 hash:      {file_hash}")
print(f"First 50 bytes:   {content[:50].hex()}")
print(f"Last 50 bytes:    {content[-50:].hex()}")
print()

print("=" * 60)
print("File Information Summary")
print("=" * 60)
print()
print("To verify the file changes when you update credentials:")
print("1. Run this script before changing credentials")
print("2. Note the hash and timestamps")
print("3. Change credentials in the dashboard")
print("4. Run this script again")
print("5. Compare - hash and timestamp should be DIFFERENT")
print()
